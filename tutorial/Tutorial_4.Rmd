# Functional Enrichment from Comparisons
## Enrichment from Up and Down Regulated Genes
Letâ€™s first select a comparison to view.

[![FigureS4.1.1](https://interactivereport.github.io/OmicsView/tutorial/figures/FigureS4.1.1.jpg)](https://interactivereport.github.io/OmicsView/tutorial/figures/FigureS4.1.1.jpg)

When Users view details of a comparison, the functional enrichment results are shown. Briefly, for each comparison, we generated the up- and down- regulate gene lists and use these lists to compare with all genes in the genome to identify functions that are significantly enriched. 

[![FigureS4.1.2](https://interactivereport.github.io/OmicsView/tutorial/figures/FigureS4.1.2.jpg)](https://interactivereport.github.io/OmicsView/tutorial/figures/FigureS4.1.2.jpg)

In the example above, this comparison is between Crohn's disease (CD) vs normal control, and the top up-regulated biological processes are defense and immune response.  
Click the left menu will switch the bar charts for different categories (Gene Ontology, KEGG, Molecular signature, Protein domain etc).
The bar charts here show the top 10 categories. To view complete results, click the Enrichment Report. 

[![FigureS4.1.3](https://interactivereport.github.io/OmicsView/tutorial/figures/FigureS4.1.3.jpg)](https://interactivereport.github.io/OmicsView/tutorial/figures/FigureS4.1.3.jpg)

In the enrichment report, the full list of functional terms are shown by order of Enrichment. 

## View Changed Genes from a Functional Term in Volcano Plot
From the bar chat, click a functional term, and you have the option to view these genes in a volcano plot. 

[![FigureS4.2.1](https://interactivereport.github.io/OmicsView/tutorial/figures/FigureS4.2.1.jpg)](https://interactivereport.github.io/OmicsView/tutorial/figures/FigureS4.2.1.jpg)


Once you click the link, volcano plot will be generated for the comparison with the changed genes from the selected term highlighted.

[![FigureS4.2.2](https://interactivereport.github.io/OmicsView/tutorial/figures/FigureS4.2.2.jpg)](https://interactivereport.github.io/OmicsView/tutorial/figures/FigureS4.2.2.jpg)

## View Enriched Pathways Directly from Comparison Details

[![FigureS4.3](https://interactivereport.github.io/OmicsView/tutorial/figures/FigureS4.3.jpg)](https://interactivereport.github.io/OmicsView/tutorial/figures/FigureS4.3.jpg)

This will automatically open the pathway visualization page, and preload the pathway and comparison. 



## Gene Set Enrichment from Ranked Genes
For each comparison, we produce a rank file for all genes using logFC. We use PAGE (Parametric Analysis of Gene Set Enrichment) to identify significant biological changes.  PAGE can be more sensitive for comparisons where the logFC is relatively small, but most genes in a functional set show the same direction of change.
The predefined gene sets were from MSigDB. 
For each comparison, the top up-regulated and down-regulated gene sets are plotted. 
[![FigureS4.4.1](https://interactivereport.github.io/OmicsView/tutorial/figures/FigureS4.4.1.jpg)](https://interactivereport.github.io/OmicsView/tutorial/figures/FigureS4.4.1.jpg)

To view the genes within a gene set using volcano plot, you can click the dot, and use the link from the pop-up. 
[![FigureS4.4.2](https://interactivereport.github.io/OmicsView/tutorial/figures/FigureS4.4.2.jpg)](https://interactivereport.github.io/OmicsView/tutorial/figures/FigureS4.4.2.jpg)

## Pathway Heatmap From Comparisons
Users can display the enriched pathways from several related comparisons, and visualize the top enriched pathways across comparisons.  Users can mix public data and inhouse comparisons.

[![FigureS4.5.1](https://interactivereport.github.io/OmicsView/tutorial/figures/FigureS4.5.1.jpg)](https://interactivereport.github.io/OmicsView/tutorial/figures/FigureS4.5.1.jpg)

The heatmap shows pathways in rows, comparisons in columns. The statistical significance is color-coded (log P-value, or Z-score). Pathways are sorted by the negative logP values from the highest to the lowest.

[![FigureS4.5.2](https://interactivereport.github.io/OmicsView/tutorial/figures/FigureS4.5.2.jpg)](https://interactivereport.github.io/OmicsView/tutorial/figures/FigureS4.5.2.jpg)

From the pathway heatmap, users can click any data point to view details. 

[![FigureS4.5.3](https://interactivereport.github.io/OmicsView/tutorial/figures/FigureS4.5.3.jpg)](https://interactivereport.github.io/OmicsView/tutorial/figures/FigureS4.5.3.jpg)



