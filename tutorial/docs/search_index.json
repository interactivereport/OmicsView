[["index.html", "Supplementary Materials - OmicsView: omics data analysis through interactive visual analytics Preface", " Supplementary Materials - OmicsView: omics data analysis through interactive visual analytics 2022-02-17 Preface https://omicsview.org From the login page, users can use their email to register an account (recommended), as this enables users to save results and upload their own data. Otherwise, a guest account can be used to view public data. "],["overview-of-data-in-omicsview.html", "Chapter 1 Overview of Data in OmicsView 1.1 Projects 1.2 Samples 1.3 Comparisons 1.4 Genes 1.5 Saved Genes and Comparisons", " Chapter 1 Overview of Data in OmicsView The homepage of OmicsView gives an overview of the data curated. The Pie-charts and Bar-graphs are reactive and change depending on the selection. Users can access the different data tables from the left menu under search, or from the shortcuts at the top menu bar. Left menu can be hidden to provide more space for tables and graphs. 1.1 Projects Individual research projects are typically associated with a published study and has NCBI GEO accession number. Users can search projects from the home page. In the search result page, click each Project ID to view the full description of a project. 1.2 Samples A project may include many samples. Each sample has its own description (full details available by clicking each Sample ID). Each sample has a gene expression profile. Users can search for specific samples using the search box. To change columns displayed in the table, go to the Display Preferences. Users can create lists by selecting specific samples using the “Create a Sample List” button. Users can then specifically download this list as a CSV.Excel/PDF. Samples from your collection can be loaded to other tools like heatmap. 1.3 Comparisons Two groups of samples are compared, and the statistic values (fold change, p-value, adjusted p-values) are computed. There are a lot of meta data available for each comparison. See the dashboard for an overview of key categories, and the detailed description of each comparison has the full information. View full details of a comparison by clicking the “C” (Review Comparison) button. View volcano plot by clicking the “V” (View Volcano Chart) button. Users can also map the comparison data onto wikipathways by clicking the “P” (View Pathway) button. The selected comparisons can be saved to your collection by creating a list using the “Create a Comparison List” button for easy loading into the plotting tools. 1.4 Genes The genome-wide gene expression values were detected in each sample using RNA-Seq or microarrays. All the human genes that have expression values are listed in gene table. The gene annotation from different platforms were all mapped to NCBI gene ID (EntrezID) for consistency across platforms. To find a gene, Users can specifically search in each field like gene symbol, gene description, gene alias, NCBI gene ID, Ensembl gene ID or Uniprot ID in the Advanced Search option. For some common genes, the symbols used in publications are often not the official symbol, and users can try search alias field in Advanced Search. For example, TP53 is often referred to as P53 in publication. Users need to search P53 in alias or tumor protein p53 in description to find it if you don’t know its official symbol. The NCBI Gene search https://www.ncbi.nlm.nih.gov/gene is a good source to get official gene symbols and IDs. Users can view full details of a gene by clicking the “G” (Review Gene) button. 1.5 Saved Genes and Comparisons Users can save selected genes or comparison for future use (e.g. multiple gene and multiple comparisons bubble plot). From gene search, check the genes you want to save, and click the yellow button “save selected genes Similarly, you can save comparisons. To view saved genes, click “My Results” link on the left menu and then “Gene Lists.” Similarly, to view the saved comparisons, select “Comparison Lists” under “My Results”: "],["visualize-gene-expression.html", "Chapter 2 Visualize Gene Expression 2.1 View Gene Expression from RNA-Seq 2.2 Change Sample Grouping in Gene Expression Plot 2.3 View Gene Expression from Microarray Data 2.4 View Gene Expression from Multiple Genes 2.5 View Gene Expression in Heatmap 2.6 Export Genes and Samples 2.7 Similar comparisons 2.8 Comparisons Venn Diagrams", " Chapter 2 Visualize Gene Expression For each gene, Users can view its expression levels across multiple samples. Most data in OmicsView are from microarray data, consisting of more than 50K samples, and nearly 3000 samples are from RNA-Seq. 2.1 View Gene Expression from RNA-Seq Choose the Gene Expression from RNA-Seq -&gt; Single Gene from left menu, and enter the official symbol of gene. Alternatively, in the gene details page, click View Gene Expression link. As an optional step, Users can choose what sample attributes to pass to the plot and use data filter to choose only a subset of data points. The Data Filter can be very useful if there are too many data points and you can focus on a few diseases or tissue types. The screenshots below show default boxplot showing all diseases, and by after filtering for few diseases. Plot showing all disease states (scroll to view other diseases). 5000 randomly selected data points out of 9538 are shown. Plot after data filtering was applied to select a few diseases. Now 410 out of 9538 data points are shown. The data filter pop-up window was shown to the left of the box plot in the screen shot below. 2.2 Change Sample Grouping in Gene Expression Plot The boxplot is created using CanvasXpress ( https://canvasxpress.org )plug-in, and sample grouping and coloring can be customized by the user. In the example below, we show how sample grouping can be changed. Once the sample grouping was changed to tissue, the box plot shows that insulin is only expressed in pancreatic islets. Users can also change how the data points are colored (default is by disease). 2.3 View Gene Expression from Microarray Data The way to view microarray data is very similar to RNA-Seq data. However, since the expression values from different array platforms are typically not directly comparable, the system by default will choose the platform with the largest number of data points. The user can override this filter if needed. In addition, we recommend the user to add data filter because typically there are too many data points from microarray data. Data filters will help the user to focus on the most important tissues or diseases. If there are still more than 5000 data points after data filer, only the first 5000 are shown in the boxplot. The sample grouping and coloring can be changed by the user. See the section 2.2 for details. 2.4 View Gene Expression from Multiple Genes Users can view multiple genes on the same boxplot. The interface is similar to single gene, here you need to enter a list of gene symbols. Users can also load the saved gene lists from your collection. In multiple gene plot, you want to filter the data to come up with a reasonable number of data points. From multiple gene plot, you can use the built-in function of CanvassXpress to change grouping and coloring. In the example plot above, we can change the setting to use group by to distinguish Crohn’s disease samples and control samples. In the updated plot above, it’s easy to see that many of these genes are expressed slightly higher in disease (red) vs. control (blue). 2.5 View Gene Expression in Heatmap Heatmap can be useful to visualize gene profiles from multiple samples. It can also provide information about how genes and samples cluster. This data is from PMID: 25003194 Users can enter genes and samples in the box, or load pre-saved genes and samples quickly from your collection. Be default, we will log2 transform the gene expression data, perform scaling of the data across samples for each gene, and limit the scaled value to -3 to 3 before displaying the data in heatmap. This works well in most situations. However, advanced users can change the options. For example, if you want to keep the order of samples as you entered, just uncheck “Enable Clustering Samples.” The heatmap is rendered by CanvasXpress. Users can change the plot size if needed. In the example heatmap, we entered a few significantly changed genes in Crohn’s disease, and choose a few disease and control samples. As shown in the heatmap, most of these genes show distinct patterns between disease and control. One of the samples GSM1598422 is labeled as disease, but its gene expression signature match those with normal control very well. Therefore from heatmap clustering, we can decide that this sample is likely an outlier, the sample may be mislabeled, or this patient had very different gene expression patterns form all other patients. 2.6 Export Genes and Samples This is a useful feature to download raw (counts) and processed (TPM values) expression matrices from the datasets. This gives the user the opportunity to do any downstream analysis on the raw reads independently. For this functionality, the samples need to belong to the same platform type and the requested limit is to 100 genes and 20 samples. The files are exported as csv and can be loaded and used by the user to perform their own downstream analysis. 2.7 Similar comparisons For a given comparison, this functionality helps identify other similar comparisons. 2.7.1 Similar comparisons (GO) To identify similar comparisons based on GO terms in up or downregulated genes. 2.7.2 Similar comparisons (PAGE) Similarly, the similar comparisons can be identified using PAGE results A list of comparisons that were found similar to the target comparison are displayed. They can be sorted on different attributed like # Terms in Comparison, # Overlaps and. Enrichment score 2.8 Comparisons Venn Diagrams A good way to identify similarities and difference between different comparisons is by using the Comparisons Venn Diagram functionality. There are two ways to use this tool: By GO terms and PAGE results. 2.8.1 Comparisons Venn Diagram (GO) For identifying similar GO terms between comparisons either in the Up and Down regulated categories, this functionality can be used. In this example, 3 comparisons from Psoriasis are probed, the user also has the option of probing 2 comparisons by leaving the third field empty. Upon finishing, an overlap summary is generated. This contains a Venn Diagram of the intersection of all the GO terms between the 3 comparisons. The count number can be clicked, as shown below, to view which terms are included. Furthermore, there is another section below this where pairs of the comparisons can be probed. Here, just A &amp; B are displayed. 2.8.2 Comparisons Venn Diagram (PAGE) Similarly, the user can probe the similarities between PAGE results or 2 or 3 comparisons. In this example we probe comparisons from Psoriasis again. Upon finishing an overlap summary is generated which shows the intersection of the PAGE results between the comparisons. "],["visualize-comparison-data.html", "Chapter 3 Visualize Comparison Data 3.1 Dashboard View of Comparison 3.2 Set Dashboard Preference 3.3 Dynamic Filtering of Comparisons on Dashboard 3.4 Bubble Plot of Comparisons Associated with a Single Gene 3.5 Data Filter and Advanced Settings in Bubble Plot 3.6 Bubble Plot of Sets of Genes and Comparisons 3.7 Get significant genes from comparisons 3.8 View Significantly Changed Genes in Bubble Plot 3.9 Volcano Plot of a Comparison 3.10 View Multiple Volcano Plots Together 3.11 Overlap Comparison Data to Pathway Graph 3.12 Pathway Plot from Several Comparisons", " Chapter 3 Visualize Comparison Data There are 235 comparisons in the demo system, covering different categories including Disease vs. Normal, Treatment vs. Control, Tissue 1 vs. Tissue 2 etc. The system offers many ways to visualize the data and help users find the most interesting data related to their study. 3.1 Dashboard View of Comparison The dashboard shows a summary of all the comparisons. The dashboard shows Comparison Categories, Cell Type, Disease State, Treatment, Platform summaries. A table is also available below the dashboard that lists all the comparisons. 3.2 Set Dashboard Preference Users can change how the comparison summary is displayed by following the red numbers. Since there are many Cell Types and Disease States, the user can choose to display only the top 15 categories, or all categories. See example screenshots below. When the user chooses only the top 15 categories, all other categories are shown as Other Cell Type. There are other data points where the Cell Type is unknown from the study. Two categories denoted as “Other” and “Unknown” can be hidden by the user in the preference. 3.3 Dynamic Filtering of Comparisons on Dashboard The user can click any chart in the dashboard to focus on one or more categories that are of interest to the study. In the example below, we are only interested in Disease vs. Normal comparisons, and we further narrow down the data to three disease areas: ulcerative colitis, Crohn’s disease, and rheumatoid arthritis. Now we are looking at 36 out of 199 comparisons. The table at the bottom of the page shows details of these 36 comparisons. The “Reset All Charts” link above the statistics panel is used to show all comparisons again. 3.4 Bubble Plot of Comparisons Associated with a Single Gene For each gene, Users can view all the available comparisons in a bubble chart. The default settings work for most users. After clicking the Plot button, you will see a plot like below: In the bubble plot, the X-axis shows log2 Fold Change of the comparison, the Y-axis shows diseases state. Each dot represents the comparison result of this gene from one comparison. The color of the dot represents cell type, and the size of the dot represents significance (-log10(FDR), larger is more significant). The user can click and unclick the color legend at right to select or deselect cell types. When mouse over a dot, more details are shown. And the user can also click the dot to link to other graphs. The tool bars at top right corner allows the user to zoom and pan the graph. 3.5 Data Filter and Advanced Settings in Bubble Plot In addition, advanced users can change settings by click “Modify Settings Button.” For example, the user may want to show a selected list of diseases. After clicking Customize in Case_DiseaseState, user can select which diseases to display in the pop-up window. After modifying the setting, the user can click plot button to view the new chart. The system will display how many data points are chosen based on the filter. 3.6 Bubble Plot of Sets of Genes and Comparisons It can be useful to look at a set of genes (e.g. all differentially expressed genes, or genes from a certain pathways) in a set of related comparisons (e.g. all from the same disease). To view this type of bubble plot, select Bubble Plot (Multiple Genes). In the Genes and Comparisons Bubble plot window, Users can now enter the symbols of the genes, and the comparison names. However, it is much easier to use the saved genes and saved comparisons features, or other tools from the system to quickly get a get set. In the example below, we use dashboard to select 8 comparisons that are for Disease vs. Normal in Crohn’s disease (CD). We save the comparisons and load in the bubble plot tool. For gene list, we get the up-regulated immune response genes from comparison GSE57945.GPL11154.DESeq2.test1 and paste into the gene names fields. In the bubble plot, the gene symbols are listed in Y-axis. The X-axis represents logFC, and color of the bubble represents comparison; the size of the bubble represents the significance. In the legend, the color keys for comparisons are shown. Users can click the color key in the legend to hide/show comparisons. The size of the color dot in the legend correlates to the largest bubble for that comparison, which is the most significant gene with the smallest FDR. 3.7 Get significant genes from comparisons Another way to get a gene set to visualize in the genes/comparisons bubble plot is to filter for significantly changed genes. To do this, first select a few comparisons from the dash board, and click the “View Significantly Changed Genes” button. Dashboard filter: In table, select comparisons and view significantly changed genes. In the significantly Changed Genes window, the comparisons from the previous page are already loaded. You can add or remove comparisons if needed. Now select direction (up-, down-, or both), and use the logFC cutoff and FDR value to get a list of genes. Depending on the comparisons, sometimes you may need to adjust the logFC and FDR values to get a good list of genes. In general, for bubble plot, using &lt;100 genes will make the graph easier to read. Once you are happy with the gene list, you can save it. You can also export the list for later use. 3.8 View Significantly Changed Genes in Bubble Plot Back to the bubble plot, Users can load the saved comparisons and saved genes and view the plot. In the example below, it can be seen that most significant genes come from up-regulated direction. 3.9 Volcano Plot of a Comparison Volcano plot is useful to view a top level summary of how many genes are significantly up- or down-regulated in a comparison. Users can use mouse to drag over an area to zoom in. Mouse over a point will show the gene details. Click the data point will show you links to other graphs. 3.10 View Multiple Volcano Plots Together Users can also show multiple comparisons side-by-side. If needed, the user can also highlight the same group of genes across the volcano plots. The resulting volcano plots are shown as below. Selected genes are shown as orange dots. 3.11 Overlap Comparison Data to Pathway Graph If Users are interested in a particular pathway, sometimes it is useful to map the RNA-Seq or microarray data to the pathway for visualization. In the pathway plot, typically we use red-blue color scale to show the log2 Fold Change. Blue is down-regulated, red is up-regulated. 3.12 Pathway Plot from Several Comparisons The user can add multiple comparisons from the pathway plot tool by clicking Add Comparison link. This is a good functionality to overlay differential genes from multiple comparisons along a pathway. In this example we use data from Connor-Robson et al., Neurobiology of Disease, 2019. In this paper, the authors perform proteomics (Mass spec) and RNAseq on diseased and normal iPSCs. They perform both the assays at 2 timepoints of differentiation: D35 and D56. This visualization will identify if the same genes are differential expressed in the proteomic and the RNAseq datasets, as well as in the two timepoints on a WikiPathway. The data was uploaded onto OmicsView. For the proteomic dataset, the protein ID was converted to the gene ID. Here the 4 comparisons (2 Proteomics and 2 RNAseq) are loaded, and the P13k Akt signaling pathway is probed. The pathway plot now has 4 color bars corresponding to the different comparisons. Users can also zoom into the plot for better visibility of the genes. The figure below is zoomed into the circular section from the plot above. In this example, many of the ECM genes are getting differentially regulated in the same direction across all 4 comparisons. If a particular gene is clicked on, like COL2A1 here, the details of changes in the gene in each comparison can be seen. "],["functional-enrichment-from-comparisons.html", "Chapter 4 Functional Enrichment from Comparisons 4.1 Enrichment from Up and Down Regulated Genes 4.2 View Changed Genes from a Functional Term in Volcano Plot 4.3 View Enriched Pathways Directly from Comparison Details 4.4 Gene Set Enrichment from Ranked Genes 4.5 Pathway Heatmap From Comparisons", " Chapter 4 Functional Enrichment from Comparisons 4.1 Enrichment from Up and Down Regulated Genes Let’s first select a comparison to view. When Users view details of a comparison, the functional enrichment results are shown. Briefly, for each comparison, we generated the up- and down- regulate gene lists and use these lists to compare with all genes in the genome to identify functions that are significantly enriched. In the example above, this comparison is between Crohn’s disease (CD) vs normal control, and the top up-regulated biological processes are defense and immune response. Click the left menu will switch the bar charts for different categories (Gene Ontology, KEGG, Molecular signature, Protein domain etc). The bar charts here show the top 10 categories. To view complete results, click the Enrichment Report. In the enrichment report, the full list of functional terms are shown by order of Enrichment. 4.2 View Changed Genes from a Functional Term in Volcano Plot From the bar chat, click a functional term, and you have the option to view these genes in a volcano plot. Once you click the link, volcano plot will be generated for the comparison with the changed genes from the selected term highlighted. 4.3 View Enriched Pathways Directly from Comparison Details This will automatically open the pathway visualization page, and preload the pathway and comparison. 4.4 Gene Set Enrichment from Ranked Genes For each comparison, we produce a rank file for all genes using logFC. We use PAGE (Parametric Analysis of Gene Set Enrichment) to identify significant biological changes. PAGE can be more sensitive for comparisons where the logFC is relatively small, but most genes in a functional set show the same direction of change. The predefined gene sets were from MSigDB. For each comparison, the top up-regulated and down-regulated gene sets are plotted. To view the genes within a gene set using volcano plot, you can click the dot, and use the link from the pop-up. 4.5 Pathway Heatmap From Comparisons Users can display the enriched pathways from several related comparisons, and visualize the top enriched pathways across comparisons. Users can mix public data and inhouse comparisons. The heatmap shows pathways in rows, comparisons in columns. The statistical significance is color-coded (log P-value, or Z-score). Pathways are sorted by the negative logP values from the highest to the lowest. From the pathway heatmap, users can click any data point to view details. "],["data-upload.html", "Chapter 5 Data Upload 5.1 Data Type 5.2 Data Upload options 5.3 Source File format 5.4 Data Formats 5.5 Gene Expression Data 5.6 Comparison Data", " Chapter 5 Data Upload OmicsView gives users the option to add their own data, or published data that is not on the portal yet. This is achieved through the “Internal Data” option under “My Results.” To add a new dataset, click on the link “Import Internal Data” that will lead you to a page like below. 5.1 Data Type There are three types of project data. The file requirements for each data type are summarized in the table below. When you select different Data Types, the Upload Your Data session in the page changes accordingly. 5.1.1 Supported Data File Format The system support two data formats: * The csv format (comma separated) * The tab delimited format Be sure that your source data files are in the supported format. Usually Auto Detect is selected as default and doesn’t need to change. 5.1.2 Expression Data Format The Gene Level Expression file can have two formats: Matrix format and Table format. Click on the Help link below the selection box to see examples. The Study option is useful if you want to include the uploaded project in a specific study. And the Access option can be checked if you want to make your project viewable by all the users. 5.2 Data Upload options Instead of uploading the source data file individually, you can compress your data files into a zip file and upload only this zip file. The application will determine the data type based on the file name. Make sure that your zip file contains the following files with exactly the same file names. You can check the requirement of the zipped file for each data type by clicking on the Requirement link under the Choose File box in the Upload Your Data session. This table below summarizes the file requirement for all data types. 5.3 Source File format You can always check the source file format by looking at the example files. They are located below each file selection box. 5.3.1 Project Info file Only ProjectID is required and must be unique across the system. The other four fields are highly recommended. The user can add one or more projects. Save the file in the supported format and upload to the system. The system has a tool to check all the available fields and existing values for the project info file. Click on Distinct Values in Table under the Other Tools in the left menu. And you will see a searching tool. Select your interested fields to check the existing values for that field. Try your best to use the same value for the same info, which can ensure your imported projects are comparable when doing cross project analysis. 5.3.2 Sample Info file Recommended fields The first three fields (in bold) are required. SampleID should be unique among the same project. The projectID field should match with the projectID field in the Project Info file. The platformName should be one from the available values in the Distinct Values table. The other fields listed here are not required but highly recommended. These are used to capture information provided by researchers about the samples. The headers must match one of the distinct fields in the Distinct Values tool. If the column header provided by the user does not match any available field, the system will show the unmatched fields in the file and let you manually map it to a known field. To check the available fields and existing values, you can also check the Distinct Values tool by selecting Samples in the box. 5.3.3 Comparison Info file Recommended fields The first three fields (in bold) are required. ComparisonID should be unique among the same project. The projectID field should match with the projectID field in the Project Info file. The platformName should be one from the available values for the platformName in the Distinct Values table. The next two fields Case.SampleIDs and Control.SampleIDs should be used to list the sampleIDs used as cases or controls for the comparison. Separate sampleIDs by comma. The other fields listed here are not required but highly recommended. For example, ComparisonCategory is used in group comparisons in dashboard. Case.DiseaseState and Case.Tissue are used in coloring or grouping bubble plots. The headers must match one of the distinct fields in the Distinct Values tool. If the column header provided by the user does not match any available field, the system will show the unmatched fields in the file and let you manually map it to a known field. 5.4 Data Formats There are certain formats for gene expression data and comparison data files. The data format below applies to both RNA-Seq and Array data. 5.5 Gene Expression Data For gene expression data (RNA-Seq or microarray), two types of formats are supported. The Gene must be listed in the first column. The IDs can be official gene symbols, gene IDs (Entrez Id), or Ensmbl IDs. The system will automatically recognize the IDs and map the IDs to the gene annotation table. The SampleIDs must match the sampleIDs in the Sample Info file. 5.6 Comparison Data For comparison data, the following template should be used. List one or more comparisons in the table. The Gene must be listed in the first column. The IDs can be official gene symbols, gene IDs (Entrez Id), or Ensmbl gene IDs. The system will automatically recognize the IDs and map the IDs to the gene annotation table. The second column must be ComparisonID, which must match the comparisonIDs for the Comparison Info file. For each row, three values should be entered, logFC is the log2 Fold Change, P.Value, and adj.P.Val (FDR). Most statistical packages output these three values. If some values are missing, enter NAs. "],["advanced-analyses.html", "Chapter 6 Advanced Analyses 6.1 Correlation Tools 6.2 PCA Analysis 6.3 Meta-Analysis", " Chapter 6 Advanced Analyses 6.1 Correlation Tools Once the user has identified a gene of interest, the user can use correlation tools to find other genes that share similar (or opposite) profiles in terms of gene expression or fold change. First, enter the gene of interest, and samples to be used for correlation. In the example below, we entered OSM gene, and 69 samples involved in Crohn’s disease. Click the plot icon will show scatter plot of the target and the correlated gene. An additional way to plotting the correlation with other genes, is to enable the log2 transformation of the expression. Now the expression is log transformed. The examples above are from Correlation Tools using Expression. The interface and usage for Correlation Tools using Comparison is similar. 6.2 PCA Analysis Users can select a few samples and use PCA plot to visualize the sample relationships. The system will use FactorMineR package to run PCA analysis and display the results. The PCA tool can also display results from pre-calculated data (basic PCA, or FactorMineR results). 6.3 Meta-Analysis Meta-Analysis can be used to identify genes that are changed consistently across multiple projects. This can be either implemented by doing Meta-analysis using comparisons or meta-analysis using gene expression. 6.3.1 Meta-Analysis (Comparisons) In the example below, we are looking for the most significant DEGs in Disease vs. Normal comparisons of Crohn’s Disease. The system will use the comparison data (logFC, p-value) to compute combined p-value and rank product. It also uses a simple cutoff to get counts of up- and down- regulated genes. This method is fast and can be applied to any comparison data. However, it does not use the individual sample data or considers number of samples in each comparison. We can enable filter by percentage up-regulated genes to focus on genes that are consistently up-regulated. From the output table, the user can select the genes most interesting to them. Some key columns are explained below. # of data points: this shows the number of comparisons with valid data for this gene. Although 8 comparisons were entered here, not all genes show up in all experiments. We used minimal 3 data points when we set up display options. Simple count results. Use the cutoff values we entered (logFC 1, FDR 0.05), the system checks if a gene pass the cutoff for each comparison, and computes percentage up- and down-regulation. Rank Products results (recommended results for meta-analysis). This is done with the RankProd package. The system rank genes in each comparison using logFC and computes a combined rank and statistical values. The Rank Products columns shows the rank (smaller is more consistent change), log2Fold Change and FDR. The Combined p-value/FDR (Fisher or Maximum) are computed using the individual p-values with MetaDE package. Note unlike RankProd, these values didn’t consider the direction of the change, so the data need to be interpreted carefully, and we recommend using these p-values together with the simple count values to have a better understanding. The table can be sorted by any column. In the above view, we sorted the data by logFC. The table can also be sorted by # of data points to view the genes with most data. In the example below, we chose 10 up-regulated genes with most data points form the table and used the bubble plot button to create bubble plot. It can be seen that indeed all these genes show consistent up-regulated in the selected comparisons. The resulting bubble plot will show all 8 comparisons for each gene. We can also create a gene list from the table for up or down gene lists from meta-analysis (using the green button at top of meta-analysis results) and use the list for subsequent study like functional enrichment or generating heatmap. Below is a heatmap using 100 up-regulated genes from meta-analysis, nd its very clear that the diseased samples have an upregulation of these genes. 6.3.2 Meta-Analysis (Gene Expression) In the example below, we use the same comparisons from Crohn’s disease. By default, the Rank Product Analysis is checked. Uncheck this if the data is too big for Rank product analysis, or you just need a quick run using limma for each individual comparison. In the next page, system will display the Case and Control samples for each comparison. At this step, users can edit samples. Users can use this page to remove outliers or add other samples they want to include in the meta-analysis. After users review the samples for each comparison, they can go to next step to run the meta-analysis. This step can take a while if the number of samples are large. For the meta-analysis, the system will do the following: Run limma to get logFC, p-valua and confidence interval for each individual comparison Run MetaDE to get combined p-values Run Rank Product package for all the expression data to get statistical significance and combined logFC. This step can be very slow is number of samples are large. After the analysis is done, the system will show a summary and the result table. In the summary, the four comparisons are shown, along with number of genes used for meta-analysis, and number of case and control samples. Because different platforms (especially arrays) have different number of genes present, and some genes may have too low signals to be detected in certain projects, not all genes are present in all the comparisons. In this example, 19,214 genes are present in all comparisons. In some cases, it may be beneficial to remove some comparisons with small number of genes. In the meta-analysis result table, results from Rank Product are shown (from RankProd package, preferred results to use), followed by effective size method (MetaDE.ES from MetaDE package). The logFC, SE, confidence internal, p-value and FDR for each comparison is shown next. The comparison numbers are the same as those listed in the summary table above. The gene list can be sorted by RankProd (most significant changes) or by logFC_RP (up or down-regulated). From this analysis, we can create Forest plot for each gene by click the icon near the gene symbol. In the Forest plot, results from individual comparison and combined data are shown. The confidence internal for individual comparison is based on limma output. The confidence internal for combined results is based on p-value from RankProd (or ES method when RankProd is not run). The plot can be saved as SVG or PDF. The summary table is shown below the plot. "],["step-by-step-guide-of-crohns-disease-use-case.html", "Chapter 7 Step-by-step guide of Crohn’s disease use case", " Chapter 7 Step-by-step guide of Crohn’s disease use case To provide more guidance on how to carry out an analysis, in this section an end-to-end example is shown to demonstrate how to draw meaningful conclusions by data exploration. Step 1: Select Disease versus Normal Crohn’s Disease comparisons In main Comparison Dashboard click on “Disease Vs. Normal” Step 2: Select Crohn’s Disease comparisons Click on the “Crohn’s Disease” bar in the Disease State subpanel of the Comparison Dashboard Step 3: Add comparisons to a Comparison List Scroll down same Comparisons Dashboard page to the table at the bottom. Click on box that selects all 8 comparisons – will see 8 check marks as in screenshot below Then click “Create a Comparison List” Step 4: Name comparison list Fill “Name” field, then click “Create Comparison List” Step 5: Create Pathway Heatmap Use menu on left, and click “Pathway Heatmap Tool” Then click “Load Saved Comparisons” Then select the Comparison List we just created “Crohns demo” Then checkbox “Use comparison info instead of comparison ID” (to provide more information), and click on “Get Gene Sets” button Pathway heatmap is then displayed which provides insight into highly activated immune related signature responses including TNF alpha: Step 6: Create Pathway Level visualization for TNF alpha pathway On left menu pick KEGG Visualization (could pick Wiki or Reactome too and search for TNF pathway) Then click “Select Pathway” Then type TNF in search and hit “Select” on the TNF signaling pathway that comes up Next load saved comparisons by clicking “Load from saved lists.” Select “Crohns demo” from My Saved List and Close window. Then click “Submit” Detailed TNF pathway is then displayed with coloring by fold change of up or down regulation for each of the 8 disease-versus-control comparisons. Allows the user to home in on key nodes that show consistent dysregulation across conditions. Step 7 : Meta analysis of differentially expressed genes (Comparisons) across studies Click on “Meta Analysis (Comparisons)” on the left-hand navigation panel Click on “Load Saved Comparison IDs” (i.e., saved Comparison List). Select previously created “Crohns demo” list and click “Select” Click “Submit” Results table can be sorted by column headers to get a top list that is ranked by a variety of metrics. Table then shows genes that have very consistent up and down regulation across all conditions/studies Step 8 Create bubble plot from metaanlysis results Select top genes from Metaanalysis table Click “Bubble Plot” Click “Plot” Bubble plot gives a clear visual on the extent of change of each gene and the significance across each study. Allows user to see if some studies/comparisons are “outliers” with respect to gene changes. "],["methods.html", "Chapter 8 Methods 8.1 Data processing 8.2 Functional and Pathway Enrichment", " Chapter 8 Methods 8.1 Data processing Public datasets The public datasets that are accessible through OmicsView are a subset of the DiseaseLand https://www.qiagenbioinformatics.com/diseaseland/ database. The DiseaseLand data service uses common analysis pipelines to quantify and normalize publicly available microarray and RNA-seq expression data from raw files. For each project, and each sample, metadata are curated to apply controlled vocabularies and ensure consistent formatting of terms. Information on the data processing pipeline and DiseaseLand product is available at the following links ( http://www.arrayserver.com/wiki/index.php?title=DiseaseLand_Curation_Pipeline, http://www.arrayserver.com/wiki/index.php?title=Omicsoft_Affymetrix_Microarray_Preprocessing, http://www.arrayserver.com/wiki/index.php?title=RNA-Seq_Normalized_FPKM_Values_in_Land ). The data in OmicsView was exported from DiseaseLand prior to 8/27/2019. No OmicsView data can be exported from the portal, distributed with a software package, or otherwise redistributed without express permission from QIAGEN. 8.2 Functional and Pathway Enrichment The function enrichment algorithms implemented in OmicsView come in two flavors – one is based on hypergeometric enrichment of differentially expressed genes (DEGs) against a number of knowledge databases, based on the HOMER package (http://homer.salk.edu/homer/microarray/go.html). This requires a significance cutoff to be applied to the two group comparison expression data such that we can select a set of genes that is upregulated and downregulated, i.e., differentially expressed genes. The HOMER package comes with some collections of gene knowledge databases that we use for enrichment. The second approach is based on a variant of the Gene Set Enrichment Analysis (GSEA) approach called PAGE (Parametric Analysis of Gene Set Enrichment) which is faster than the original GSEA approach and more sensitive1. We use an implementation of PAGE that is in the R piano package (https://www.bioconductor.org/packages/release/bioc/html/piano.html). GSEA based approaches just require a ranked list of genes (genes with a numeric quantity for ranking them that shows how different they are between groups in the comparison, usually logFC values) and are typically more sensitive in picking up pathway enrichment. Both packages come pre-built with a set of known functions/pathways in the form of gene sets, against which we look for enrichment in the comparison of interest. 8.2.1 HOMER workflow 8.2.1.1 Selection of Differentially Expressed Genes (DEGs) for enrichment analysis For each comparison, we generated the up- and down-regulated gene lists as input for functional enrichment analysis. We used a dynamic cutoff of logFC and AdjustedPValue / PValue to aim for 200-2000 genes in each list. To achieve this we start with a stringent cutoff of adjusted p-value of 0.05, and 2-fold change up or down, if we get more than 200 genes we use these, otherwise we drop to nominal p-value of 0.01 (with 2-fold up or down), and if we do not reach 200 we drop again to 1.2 fold up or down with adjusted p-value of 0.1. If the most lenient cutoff does not generate a list of 50 up or down genes, we take the top 50 logFC (negative and positive) to generate the lists for enrichment analysis. 8.2.1.2 Functional Enrichment of DEG list against genome The findGo.pl program from Homer package ( http://homer.salk.edu/homer/microarray/go.html ) is used to analyze the functional enrichment for each DEG list. There are several different “ontologies,” or libraries of gene groupings that came with the Homer package. We used Homer version v4.8.3, human-o v5.8 and mouse-o v5.8 libraries (current as of Dec 6 2016). These include, Gene Ontology: Biological Process, Molecular Function, Cellular Component Chromosome Location: Genes with similar chromosome localization (NCBI Entrez Gene) KEGG Pathways: Groups of proteins in the same pathways (From KEGG) Protein-Protein Interactions: Groups of proteins interacting with the same protein (From NCBI Entrez Gene) Interpro: Proteins with similar domains and features (Interpro) Pfam: Proteins with similar domains and features (Pfam) SMART: Proteins with similar domains and features (SMART) Gene3D: Proteins with similar domains and features (Gene3D Database) Prosite: Proteins with similar domains and features (Prosite Database) PRINTS: Proteins with similar domains and features (PRINTS Database) MSigDB: Lists of genes maintained by the Molecular Signature Database (includes many different categories of genes (MSigDB) BIOCYC: Groups of proteins in the same pathway (NCBI Biosystems/BIOCYC) COSMIC: Human proteins that are mutated in the same cancers (COSMIC) GWAS Catalog: Human genes with risk SNPs identified in their vicinity for the same disease (GWAS Catalog) Lipid Maps: Mouse proteins found in the same lipid processing pathways (NCBI Biosystems/LIPID MAPS) Pathway Interaction Database: Proteins in the same pathway (NCBI Biosystems/PID) REACTOME: Proteins in the same biochemical pathways (NCBI Biosystems/REACTOME) SMPDB: Proteins in the same pathway (SMPDB) Wikipathways: Protein in the same pathway (Wikipathways) The HTML output file from HOMER is further enhanced by a custom php script to make it more user friendly. 8.2.2 Gene Set Enrichment Analysis (GSEA) workflow (PAGE) For our second enrichment tool, we used a variation of the GSEA method, PAGE (Parametric Analysis of Gene Set Enrichment) [1] to process the comparison data as PAGE is much faster than GSEA and also more sensitive. For each comparison, we produce a rank file with gene symbol and logFC values. If a gene symbol appears multiple times in the same comparison, the average logFC is used. Human gene sets are downloaded from MsigDB (http://software.broadinstitute.org/gsea/msigdb). Version 5.2 (msigdb.v5.2.symbols.gmt). Mouse gene sets are downloaded from Bader Lab from Univ. of Toronto (http://baderlab.org/GeneSets). The version is December_01_2016 (Mouse_GO_AllPathways_with_GO_iea_December_01_2016_symbol.gmt) . This gmt file contains special characters that cannot be used by R piano package, therefore we manually replace special characters to “/” or “ _” . In addition, some mouse gene sets have the same name, so we added suffix _altSetX to make all the names unique. 8.2.2.1 PAGE Analysis using R piano package The R package piano (https://bioconductor.org/packages/release/bioc/html/piano.html) is used to run the PAGE analysis for all the rank files. To simplify the piano output, we combined down-regulated and up-regulated gene sets into a single table for each gene set. From the piano results we extract out the p-value, FDR and Z-score. 8.2.3 Meta-Analysis The meta-analysis functions allow a user to combine expression data across multiple studies to find changes that are robust. DiseaseAtlas offers two ways to perform meta-analysis: The first method works on comparison data. The system will use the comparison data (logFC, p-value) to compute combined p-value and rank product. This method is fast and can be applied to any type of comparison data. However, it does not use the individual sample data, nor does it consider the number of samples in each comparison. The second method uses per sample Gene Expression data. The user will have input a list of factors that indicate comparisons across or within studies and then gene level significant changes are recomputed by extracting expression data from all samples for each comparison, and then applying the RankProd [2] and/or MetaDE [3] packages to perform meta-analysis. Limma is also applied to get statistics for each individual comparison. This analysis takes much longer (10 minutes to an hour for a typical analysis, even longer if number of samples are very large), and it has more strict sample requirements (no samples can occur in two different comparisons). Statistically, the second method is more robust. For consistently changed genes, both methods should detect them. 8.2.4 Meta-analysis statistics For comparison data the combined p-value is computed using Fisher’s method, that is -2(sum of ln(p-value)) is compared against a Chi-squared distribution with N degrees of freedom, where N is the number of p-values being combined. This is carried out for every gene and yields a combined p-value that is reported. Another simpler approach is to report the maximum p-value for the gene across all the comparisons – a much more stringent measure of overall significance. This approach to combining p-values is implemented in the MetaDE R package (https://github.com/metaOmics/MetaDE). Note MetaDE will not produce results if &gt; 30% of the comparisons for a gene have missing values for the p-value. Note that the p-value combination does not* take into account the direction of the fold change (up or down) so the Up regulated &amp; Down regulated percentage summaries need to be also referred to for clarification. The RankProd method (https://bioconductor.org/packages/release/bioc/html/RankProd.html) converts log2 fold changes across all genes in a comparison to ranks and then computes a meta-statistic per gene which is the geometric mean of the ranks across comparisons. It is a non-parametric approach, and computes statistical significance based on a permutation approach which also addresses the multiple testing aspect of looking for significance within the set of all genes in the transcriptome. References: Kim, S.Y., &amp; Volsky, D.J. (2005). PAGE: parametric analysis of gene set enrichment. BMC bioinformatics, 6, 144 (2005). Del Carratore, D et al. RankProd 2.0: a refactored Bioconductor package for detecting differentially expressed features in molecular profiling datasets. Bioinformatics 33 (17), 2774-2775 (2017). Ma, T. et al. Metaomics: analysis pipeline and browser-based software suite for transcriptomic meta-analysis. Bioinformatics 35 (9), 1597-1599 (2019). "],["404.html", "Page not found", " Page not found The page you requested cannot be found (perhaps it was moved or renamed). You may want to try searching to find the page's new location, or use the table of contents to find the page you are looking for. "]]
