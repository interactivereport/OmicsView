<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>
<link rel="stylesheet" type="text/css" href="htmlwidgets/lib/scatterD3/scatterD3.css">
<link rel="stylesheet" type="text/css" href="htmlwidgets/lib/d3-lasso-plugin/lasso.css">

<script type="text/javascript" src="htmlwidgets/htmlwidgets.js"></script>
<!-- <script type="text/javascript" src="htmlwidgets/lib/d3/d3-4.2.6.min.js"></script> -->

<script src="http://d3js.org/d3.v3.min.js" charset="utf-8"></script>

<script type="text/javascript" src="htmlwidgets/lib/d3/d3-array.v1.min.js"></script>
<script type="text/javascript" src="htmlwidgets/lib/d3/d3-axis.v1.min.js"></script>
<script type="text/javascript" src="htmlwidgets/lib/d3/d3-collection.v1.min.js"></script>
<script type="text/javascript" src="htmlwidgets/lib/d3/d3-color.v1.min.js"></script>
<script type="text/javascript" src="htmlwidgets/lib/d3/d3-dispatch.v1.min.js"></script>
<script type="text/javascript" src="htmlwidgets/lib/d3/d3-drag.v1.min.js"></script>
<script type="text/javascript" src="htmlwidgets/lib/d3/d3-ease.v1.min.js"></script>
<script type="text/javascript" src="htmlwidgets/lib/d3/d3-format.v1.min.js"></script>
<script type="text/javascript" src="htmlwidgets/lib/d3/d3-interpolate.v1.min.js"></script>
<script type="text/javascript" src="htmlwidgets/lib/d3/d3-legend.min.js"></script>
<script type="text/javascript" src="htmlwidgets/lib/d3/d3-path.v1.min.js"></script>
<script type="text/javascript" src="htmlwidgets/lib/d3/d3-scale.v1.min.js"></script>
<script type="text/javascript" src="htmlwidgets/lib/d3/d3-selection.v1.min.js"></script>
<script type="text/javascript" src="htmlwidgets/lib/d3/d3-shape.v1.min.js"></script>
<script type="text/javascript" src="htmlwidgets/lib/d3/d3-timer.v1.min.js"></script>
<script type="text/javascript" src="htmlwidgets/lib/d3/d3-transition.v1.min.js"></script>
<script type="text/javascript" src="htmlwidgets/lib/d3/d3-zoom-patched.min.js"></script>


<script type="text/javascript" src="htmlwidgets/lib/d3-lasso-plugin/lasso.js"></script>
<script type="text/javascript" src="htmlwidgets/lib/scatterD3/scatterD3.js"></script>
<script type="text/javascript" src="htmlwidgets/lib/scatterD3/scatterD3-arrows.js"></script>
<script type="text/javascript" src="htmlwidgets/lib/scatterD3/scatterD3-axes.js"></script>
<script type="text/javascript" src="htmlwidgets/lib/scatterD3/scatterD3-dots.js"></script>
<script type="text/javascript" src="htmlwidgets/lib/scatterD3/scatterD3-ellipses.js"></script>
<script type="text/javascript" src="htmlwidgets/lib/scatterD3/scatterD3-exports.js"></script>
<script type="text/javascript" src="htmlwidgets/lib/scatterD3/scatterD3-labels.js"></script>
<script type="text/javascript" src="htmlwidgets/lib/scatterD3/scatterD3-lasso.js"></script>
<script type="text/javascript" src="htmlwidgets/lib/scatterD3/scatterD3-legend.js"></script>
<script type="text/javascript" src="htmlwidgets/lib/scatterD3/scatterD3-lines.js"></script>
<script type="text/javascript" src="htmlwidgets/lib/scatterD3/scatterD3-setup.js"></script>
<script type="text/javascript" src="htmlwidgets/lib/scatterD3/scatterD3-utils.js"></script>

<script type="text/javascript" src="htmlwidgets/labeler.js"></script>

</head>

<body>
<div id="htmlwidget_1" style="width:640px;height:480px;" class="scatterD3 html-widget"></div>

<script type="text/javascript">

        var widgets = HTMLWidgets.widgets;
        var jed = widgets.filter(function(widget){
          return widget.name == "scatterD3"
        })[0];


        var el = document.getElementById('htmlwidget_1');
        var instance = jed.initialize(el, 640, 480);

        var parameters = {
          "data": {

            "x": [0.62, 0.875],

            "y": [0.32, 0.21],

            "col_var": ["6", "6"],

            "lab": ["Mazda RX4", "Mazda RX4 Wag"],

            "symbol_var": ["4", "4"],

            "key_var": [1, 2],

            "type_var": ["point", "arrow"]

          },
            "settings": {
            "x_log": false,
            "y_log": false,
            "labels_size": 10,
            "labels_positions": null,
            "point_size": 64,
            "point_opacity": 1,
            "hover_size": 1,
            "hover_opacity": null,
            "xlab": "wt",
            "ylab": "mpg",
            "has_labels": true,
            "col_lab": "cyl",
            "col_continuous": false,
            "colors": null,
            "ellipses": false,
            "ellipses_data": [],
            "symbol_lab": "gear",
            "size_range": [10, 300],
            "size_lab": "NULL",
            "opacity_lab": "NULL",
            "unit_circle": true,
            "has_color_var": true,
            "has_symbol_var": true,
            "has_size_var": false,
            "has_opacity_var": false,
            "has_url_var": false,
            "has_legend": true,
            "has_tooltips": true,
            "tooltip_text": null,
            "has_custom_tooltips": false,
            "click_callback": null,
            "zoom_callback": null,
            "fixed": false,
            "legend_width": 150,
            "left_margin": 30,
            "html_id": "scatterD3-RALOWFSR",
            "xlim": [-1.2, 1.2],
            "ylim": [-1.2, 1.2],
            "x_categorical": false,
            "y_categorical": false,
            "menu": true,
            "lasso": true,
            "lasso_callback": null,
            "dom_id_reset_zoom": "scatterD3-reset-zoom",
            "dom_id_svg_export": "scatterD3-svg-export",
            "dom_id_lasso_toggle": "scatterD3-lasso-toggle",
            "transitions": false,
            "axes_font_size": "100%",
            "legend_font_size": "100%",
            "caption": null,
            "lines": {
              "slope": [0, null],
              "intercept": [0, 0],
              "stroke_dasharray": [5, 5]
            },
            "hashes": []
          }
        };

        instance.renderValue(parameters);


        //------------------------------------------------------------------------------------------
        // Test Labeler
        //------------------------------------------------------------------------------------------

        function gaussian() {
            // Box-Muller transformation
            do
            {
                u = 2 * Math.random() - 1;
                v = 2 * Math.random() - 1;
                r = u * u + v * v;
            }
            while (r >= 1.0);

            var c = Math.sqrt(-2 * Math.log(r) / r );
            return u * c;
        }

        function redrawLabels() {
          // Redraw labels and leader lines
          labels
            .transition()
            .duration(800)
            .attr("x", function(d) { return (d.x); })
            .attr("y", function(d) { return (d.y); });

          links
            .transition()
            .duration(800)
            .attr("x2",function(d) { return (d.x); })
            .attr("y2",function(d) { return (d.y); });
        }



        var label_array = [
          {
            x: parameters.data.x[0],
            y: parameters.data.y[0],
            name: "Node 3",
            width: 1.0,
            height: 1.2
          },
          {
            x: parameters.data.x[1],
            y: parameters.data.y[1],
            name: "Node 2",
            width: 1.0,
            height: 1.2
          }
        ];

        var anchor_array = [
          {x: 0.3, y: 0.2, r: 0.1},
          {x: -0.3, y: -0.2, r: 0.1},
        ];

        var w = 500;
        var h = 500;
        var nsweeps = 1000;

        var labels = d3.labeler()
               .label(label_array)
               .anchor(anchor_array)
               .width(w)
               .height(h)
               .start(nsweeps);


        redrawLabels();


</script>

</body>
</html>
